/**
 * @remix-run/router v1.6.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L.apply(this,arguments)}var j;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(j||(j={}));const et="popstate";function Lr(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:d,hash:u}=n.location;return be("",{pathname:s,search:d,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Re(a)}return Nt(t,r,null,e)}function F(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function se(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function jt(){return Math.random().toString(36).substr(2,8)}function tt(e,t){return{usr:e.state,key:e.key,idx:t}}function be(e,t,r,n){return r===void 0&&(r=null),L({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?re(t):t,{state:r,key:t&&t.key||n||jt()})}function Re(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function re(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Nt(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,d=a.history,u=j.Pop,f=null,y=h();y==null&&(y=0,d.replaceState(L({},d.state,{idx:y}),""));function h(){return(d.state||{idx:null}).idx}function g(){u=j.Pop;let b=h(),o=b==null?null:b-y;y=b,f&&f({action:u,location:U.location,delta:o})}function E(b,o){u=j.Push;let P=be(U.location,b,o);r&&r(P,b),y=h()+1;let A=tt(P,y),D=U.createHref(P);try{d.pushState(A,"",D)}catch{a.location.assign(D)}s&&f&&f({action:u,location:U.location,delta:1})}function _(b,o){u=j.Replace;let P=be(U.location,b,o);r&&r(P,b),y=h();let A=tt(P,y),D=U.createHref(P);d.replaceState(A,"",D),s&&f&&f({action:u,location:U.location,delta:0})}function C(b){let o=a.location.origin!=="null"?a.location.origin:a.location.href,P=typeof b=="string"?b:Re(b);return F(o,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,o)}let U={get action(){return u},get location(){return e(a,d)},listen(b){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(et,g),f=b,()=>{a.removeEventListener(et,g),f=null}},createHref(b){return t(a,b)},createURL:C,encodeLocation(b){let o=C(b);return{pathname:o.pathname,search:o.search,hash:o.hash}},push:E,replace:_,go(b){return d.go(b)}};return U}var B;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(B||(B={}));const Ht=new Set(["lazy","caseSensitive","path","id","index","children"]);function Wt(e){return e.index===!0}function pt(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((a,s)=>{let d=[...r,s],u=typeof a.id=="string"?a.id:d.join("-");if(F(a.index!==!0||!a.children,"Cannot specify children on an index route"),F(!n[u],'Found a route id collision on id "'+u+`".  Route id's must be globally unique within Data Router usages`),Wt(a)){let f=L({},a,t(a),{id:u});return n[u]=f,f}else{let f=L({},a,t(a),{id:u,children:void 0});return n[u]=f,a.children&&(f.children=pt(a.children,t,d,n)),f}})}function ye(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?re(t):t,a=Pe(n.pathname||"/",r);if(a==null)return null;let s=mt(e);$t(s);let d=null;for(let u=0;d==null&&u<s.length;++u)d=Zt(s[u],rr(a));return d}function mt(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,d,u)=>{let f={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:d,route:s};f.relativePath.startsWith("/")&&(F(f.relativePath.startsWith(n),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(n.length));let y=ve([n,f.relativePath]),h=r.concat(f);s.children&&s.children.length>0&&(F(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),mt(s.children,t,h,y)),!(s.path==null&&!s.index)&&t.push({path:y,score:Jt(y,s.index),routesMeta:h})};return e.forEach((s,d)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))a(s,d);else for(let f of gt(s.path))a(s,d,f)}),t}function gt(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let d=gt(n.join("/")),u=[];return u.push(...d.map(f=>f===""?s:[s,f].join("/"))),a&&u.push(...d),u.map(f=>e.startsWith("/")&&f===""?"/":f)}function $t(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Qt(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Kt=/^:\w+$/,Vt=3,Yt=2,Gt=1,Xt=10,qt=-2,rt=e=>e==="*";function Jt(e,t){let r=e.split("/"),n=r.length;return r.some(rt)&&(n+=qt),t&&(n+=Yt),r.filter(a=>!rt(a)).reduce((a,s)=>a+(Kt.test(s)?Vt:s===""?Gt:Xt),n)}function Qt(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Zt(e,t){let{routesMeta:r}=e,n={},a="/",s=[];for(let d=0;d<r.length;++d){let u=r[d],f=d===r.length-1,y=a==="/"?t:t.slice(a.length)||"/",h=er({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},y);if(!h)return null;Object.assign(n,h.params);let g=u.route;s.push({params:n,pathname:ve([a,h.pathname]),pathnameBase:lr(ve([a,h.pathnameBase])),route:g}),h.pathnameBase!=="/"&&(a=ve([a,h.pathnameBase]))}return s}function er(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=tr(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],d=s.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((y,h,g)=>{if(h==="*"){let E=u[g]||"";d=s.slice(0,s.length-E.length).replace(/(.)\/+$/,"$1")}return y[h]=nr(u[g]||"",h),y},{}),pathname:s,pathnameBase:d,pattern:e}}function tr(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),se(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(d,u)=>(n.push(u),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function rr(e){try{return decodeURI(e)}catch(t){return se(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function nr(e,t){try{return decodeURIComponent(e)}catch(r){return se(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function Pe(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function ar(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?re(e):e;return{pathname:r?r.startsWith("/")?r:or(r,t):t,search:sr(n),hash:dr(a)}}function or(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ke(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yt(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function ir(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=re(e):(a=L({},e),F(!a.pathname||!a.pathname.includes("?"),ke("?","pathname","search",a)),F(!a.pathname||!a.pathname.includes("#"),ke("#","pathname","hash",a)),F(!a.search||!a.search.includes("#"),ke("#","search","hash",a)));let s=e===""||a.pathname==="",d=s?"/":a.pathname,u;if(n||d==null)u=r;else{let g=t.length-1;if(d.startsWith("..")){let E=d.split("/");for(;E[0]==="..";)E.shift(),g-=1;a.pathname=E.join("/")}u=g>=0?t[g]:"/"}let f=ar(a,u),y=d&&d!=="/"&&d.endsWith("/"),h=(s||d===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(y||h)&&(f.pathname+="/"),f}const ve=e=>e.join("/").replace(/\/\/+/g,"/"),lr=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sr=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,dr=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class vt{constructor(t,r,n,a){a===void 0&&(a=!1),this.status=t,this.statusText=r||"",this.internal=a,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function cr(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const wt=["post","put","patch","delete"],ur=new Set(wt),fr=["get",...wt],hr=new Set(fr),pr=new Set([301,302,303,307,308]),mr=new Set([307,308]),je={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},gr={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},nt={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},bt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",yr=!Rt,vr=e=>({hasErrorBoundary:!!e.hasErrorBoundary});function Ar(e){F(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let t;if(e.mapRouteProperties)t=e.mapRouteProperties;else if(e.detectErrorBoundary){let i=e.detectErrorBoundary;t=l=>({hasErrorBoundary:i(l)})}else t=vr;let r={},n=pt(e.routes,t,void 0,r),a,s=e.basename||"/",d=L({v7_normalizeFormMethod:!1,v7_prependBasename:!1},e.future),u=null,f=new Set,y=null,h=null,g=null,E=e.hydrationData!=null,_=ye(n,e.history.location,s),C=null;if(_==null){let i=G(404,{pathname:e.history.location.pathname}),{matches:l,route:c}=ct(n);_=l,C={[c.id]:i}}let U=!_.some(i=>i.route.lazy)&&(!_.some(i=>i.route.loader)||e.hydrationData!=null),b,o={historyAction:e.history.action,location:e.history.location,matches:_,initialized:U,navigation:je,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||C,fetchers:new Map,blockers:new Map},P=j.Pop,A=!1,D,z=!1,N=!1,Y=[],Z=[],I=new Map,$e=0,Le=-1,de=new Map,ce=new Set,ne=new Map,ee=new Map,q=new Map,Ae=!1;function Pt(){return u=e.history.listen(i=>{let{action:l,location:c,delta:p}=i;if(Ae){Ae=!1;return}se(q.size===0||p!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let m=Je({currentLocation:o.location,nextLocation:c,historyAction:l});if(m&&p!=null){Ae=!0,e.history.go(p*-1),De(m,{state:"blocked",location:c,proceed(){De(m,{state:"proceeding",proceed:void 0,reset:void 0,location:c}),e.history.go(p)},reset(){he(m),H({blockers:new Map(b.state.blockers)})}});return}return J(l,c)}),o.initialized||J(j.Pop,o.location),b}function Lt(){u&&u(),f.clear(),D&&D.abort(),o.fetchers.forEach((i,l)=>Ue(l)),o.blockers.forEach((i,l)=>he(l))}function At(i){return f.add(i),()=>f.delete(i)}function H(i){o=L({},o,i),f.forEach(l=>l(o))}function ue(i,l){var c,p;let m=o.actionData!=null&&o.navigation.formMethod!=null&&X(o.navigation.formMethod)&&o.navigation.state==="loading"&&((c=i.state)==null?void 0:c._isRedirect)!==!0,R;l.actionData?Object.keys(l.actionData).length>0?R=l.actionData:R=null:m?R=o.actionData:R=null;let M=l.loaderData?dt(o.loaderData,l.loaderData,l.matches||[],l.errors):o.loaderData;for(let[v]of q)he(v);let w=A===!0||o.navigation.formMethod!=null&&X(o.navigation.formMethod)&&((p=i.state)==null?void 0:p._isRedirect)!==!0;a&&(n=a,a=void 0),H(L({},l,{actionData:R,loaderData:M,historyAction:P,location:i,initialized:!0,navigation:je,revalidation:"idle",restoreScrollPosition:Qe(i,l.matches||o.matches),preventScrollReset:w,blockers:new Map(o.blockers)})),z||P===j.Pop||(P===j.Push?e.history.push(i,i.state):P===j.Replace&&e.history.replace(i,i.state)),P=j.Pop,A=!1,z=!1,N=!1,Y=[],Z=[]}async function Ke(i,l){if(typeof i=="number"){e.history.go(i);return}let c=Ne(o.location,o.matches,s,d.v7_prependBasename,i,l==null?void 0:l.fromRouteId,l==null?void 0:l.relative),{path:p,submission:m,error:R}=at(d.v7_normalizeFormMethod,!1,c,l),M=o.location,w=be(o.location,p,l&&l.state);w=L({},w,e.history.encodeLocation(w));let v=l&&l.replace!=null?l.replace:void 0,x=j.Push;v===!0?x=j.Replace:v===!1||m!=null&&X(m.formMethod)&&m.formAction===o.location.pathname+o.location.search&&(x=j.Replace);let S=l&&"preventScrollReset"in l?l.preventScrollReset===!0:void 0,W=Je({currentLocation:M,nextLocation:w,historyAction:x});if(W){De(W,{state:"blocked",location:w,proceed(){De(W,{state:"proceeding",proceed:void 0,reset:void 0,location:w}),Ke(i,l)},reset(){he(W),H({blockers:new Map(o.blockers)})}});return}return await J(x,w,{submission:m,pendingError:R,preventScrollReset:S,replace:l&&l.replace})}function St(){if(Se(),H({revalidation:"loading"}),o.navigation.state!=="submitting"){if(o.navigation.state==="idle"){J(o.historyAction,o.location,{startUninterruptedRevalidation:!0});return}J(P||o.historyAction,o.navigation.location,{overrideNavigation:o.navigation})}}async function J(i,l,c){D&&D.abort(),D=null,P=i,z=(c&&c.startUninterruptedRevalidation)===!0,Bt(o.location,o.matches),A=(c&&c.preventScrollReset)===!0;let p=a||n,m=c&&c.overrideNavigation,R=ye(p,l,s);if(!R){let O=G(404,{pathname:l.pathname}),{matches:k,route:K}=ct(p);Ce(),ue(l,{matches:k,loaderData:{},errors:{[K.id]:O}});return}if(Mr(o.location,l)&&!(c&&c.submission&&X(c.submission.formMethod))){ue(l,{matches:R});return}D=new AbortController;let M=ge(e.history,l,D.signal,c&&c.submission),w,v;if(c&&c.pendingError)v={[ie(R).route.id]:c.pendingError};else if(c&&c.submission&&X(c.submission.formMethod)){let O=await Ft(M,l,c.submission,R,{replace:c.replace});if(O.shortCircuited)return;w=O.pendingActionData,v=O.pendingActionError,m=L({state:"loading",location:l},c.submission),M=new Request(M.url,{signal:M.signal})}let{shortCircuited:x,loaderData:S,errors:W}=await Ut(M,l,R,m,c&&c.submission,c&&c.fetcherSubmission,c&&c.replace,w,v);x||(D=null,ue(l,L({matches:R},w?{actionData:w}:{},{loaderData:S,errors:W})))}async function Ft(i,l,c,p,m){Se();let R=L({state:"submitting",location:l},c);H({navigation:R});let M,w=He(p,l);if(!w.route.action&&!w.route.lazy)M={type:B.error,error:G(405,{method:i.method,pathname:l.pathname,routeId:w.route.id})};else if(M=await me("action",i,w,p,r,t,s),i.signal.aborted)return{shortCircuited:!0};if(le(M)){let v;return m&&m.replace!=null?v=m.replace:v=M.location===o.location.pathname+o.location.search,await fe(o,M,{submission:c,replace:v}),{shortCircuited:!0}}if(we(M)){let v=ie(p,w.route.id);return(m&&m.replace)!==!0&&(P=j.Push),{pendingActionData:{},pendingActionError:{[v.route.id]:M.error}}}if(te(M))throw G(400,{type:"defer-action"});return{pendingActionData:{[w.route.id]:M.data}}}async function Ut(i,l,c,p,m,R,M,w,v){let x=p;x||(x=L({state:"loading",location:l,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},m));let S=m||R?m||R:x.formMethod&&x.formAction&&x.formData&&x.formEncType?{formMethod:x.formMethod,formAction:x.formAction,formData:x.formData,formEncType:x.formEncType}:void 0,W=a||n,[O,k]=ot(e.history,o,c,S,l,N,Y,Z,ne,W,s,w,v);if(Ce(T=>!(c&&c.some(V=>V.route.id===T))||O&&O.some(V=>V.route.id===T)),O.length===0&&k.length===0){let T=Xe();return ue(l,L({matches:c,loaderData:{},errors:v||null},w?{actionData:w}:{},T?{fetchers:new Map(o.fetchers)}:{})),{shortCircuited:!0}}if(!z){k.forEach(V=>{let oe=o.fetchers.get(V.key),Be={state:"loading",data:oe&&oe.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(V.key,Be)});let T=w||o.actionData;H(L({navigation:x},T?Object.keys(T).length===0?{actionData:null}:{actionData:T}:{},k.length>0?{fetchers:new Map(o.fetchers)}:{}))}Le=++$e,k.forEach(T=>{T.controller&&I.set(T.key,T.controller)});let K=()=>k.forEach(T=>ae(T.key));D&&D.signal.addEventListener("abort",K);let{results:pe,loaderResults:Te,fetcherResults:Me}=await Ye(o.matches,c,O,k,i);if(i.signal.aborted)return{shortCircuited:!0};D&&D.signal.removeEventListener("abort",K),k.forEach(T=>I.delete(T.key));let Q=ut(pe);if(Q)return await fe(o,Q,{replace:M}),{shortCircuited:!0};let{loaderData:Ee,errors:_e}=st(o,c,O,Te,v,k,Me,ee);ee.forEach((T,V)=>{T.subscribe(oe=>{(oe||T.done)&&ee.delete(V)})});let Ie=Xe(),ze=qe(Le),xe=Ie||ze||k.length>0;return L({loaderData:Ee,errors:_e},xe?{fetchers:new Map(o.fetchers)}:{})}function Ve(i){return o.fetchers.get(i)||gr}function Ct(i,l,c,p){if(yr)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");I.has(i)&&ae(i);let m=a||n,R=Ne(o.location,o.matches,s,d.v7_prependBasename,c,l,p==null?void 0:p.relative),M=ye(m,R,s);if(!M){Fe(i,l,G(404,{pathname:R}));return}let{path:w,submission:v}=at(d.v7_normalizeFormMethod,!0,R,p),x=He(M,w);if(A=(p&&p.preventScrollReset)===!0,v&&X(v.formMethod)){Tt(i,l,w,x,M,v);return}ne.set(i,{routeId:l,path:w}),_t(i,l,w,x,M,v)}async function Tt(i,l,c,p,m,R){if(Se(),ne.delete(i),!p.route.action&&!p.route.lazy){let $=G(405,{method:R.formMethod,pathname:c,routeId:l});Fe(i,l,$);return}let M=o.fetchers.get(i),w=L({state:"submitting"},R,{data:M&&M.data," _hasFetcherDoneAnything ":!0});o.fetchers.set(i,w),H({fetchers:new Map(o.fetchers)});let v=new AbortController,x=ge(e.history,c,v.signal,R);I.set(i,v);let S=await me("action",x,p,m,r,t,s);if(x.signal.aborted){I.get(i)===v&&I.delete(i);return}if(le(S)){I.delete(i),ce.add(i);let $=L({state:"loading"},R,{data:void 0," _hasFetcherDoneAnything ":!0});return o.fetchers.set(i,$),H({fetchers:new Map(o.fetchers)}),fe(o,S,{submission:R,isFetchActionRedirect:!0})}if(we(S)){Fe(i,l,S.error);return}if(te(S))throw G(400,{type:"defer-action"});let W=o.navigation.location||o.location,O=ge(e.history,W,v.signal),k=a||n,K=o.navigation.state!=="idle"?ye(k,o.navigation.location,s):o.matches;F(K,"Didn't find any matches after fetcher action");let pe=++$e;de.set(i,pe);let Te=L({state:"loading",data:S.data},R,{" _hasFetcherDoneAnything ":!0});o.fetchers.set(i,Te);let[Me,Q]=ot(e.history,o,K,R,W,N,Y,Z,ne,k,s,{[p.route.id]:S.data},void 0);Q.filter($=>$.key!==i).forEach($=>{let Oe=$.key,Ze=o.fetchers.get(Oe),kt={state:"loading",data:Ze&&Ze.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(Oe,kt),$.controller&&I.set(Oe,$.controller)}),H({fetchers:new Map(o.fetchers)});let Ee=()=>Q.forEach($=>ae($.key));v.signal.addEventListener("abort",Ee);let{results:_e,loaderResults:Ie,fetcherResults:ze}=await Ye(o.matches,K,Me,Q,O);if(v.signal.aborted)return;v.signal.removeEventListener("abort",Ee),de.delete(i),I.delete(i),Q.forEach($=>I.delete($.key));let xe=ut(_e);if(xe)return fe(o,xe);let{loaderData:T,errors:V}=st(o,o.matches,Me,Ie,void 0,Q,ze,ee),oe={state:"idle",data:S.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(i,oe);let Be=qe(pe);o.navigation.state==="loading"&&pe>Le?(F(P,"Expected pending action"),D&&D.abort(),ue(o.navigation.location,{matches:K,loaderData:T,errors:V,fetchers:new Map(o.fetchers)})):(H(L({errors:V,loaderData:dt(o.loaderData,T,K,V)},Be?{fetchers:new Map(o.fetchers)}:{})),N=!1)}async function _t(i,l,c,p,m,R){let M=o.fetchers.get(i),w=L({state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},R,{data:M&&M.data," _hasFetcherDoneAnything ":!0});o.fetchers.set(i,w),H({fetchers:new Map(o.fetchers)});let v=new AbortController,x=ge(e.history,c,v.signal);I.set(i,v);let S=await me("loader",x,p,m,r,t,s);if(te(S)&&(S=await xt(S,x.signal,!0)||S),I.get(i)===v&&I.delete(i),x.signal.aborted)return;if(le(S)){ce.add(i),await fe(o,S);return}if(we(S)){let O=ie(o.matches,l);o.fetchers.delete(i),H({fetchers:new Map(o.fetchers),errors:{[O.route.id]:S.error}});return}F(!te(S),"Unhandled fetcher deferred data");let W={state:"idle",data:S.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(i,W),H({fetchers:new Map(o.fetchers)})}async function fe(i,l,c){var p;let{submission:m,replace:R,isFetchActionRedirect:M}=c===void 0?{}:c;l.revalidate&&(N=!0);let w=be(i.location,l.location,L({_isRedirect:!0},M?{_isFetchActionRedirect:!0}:{}));if(F(w,"Expected a location on the redirect navigation"),bt.test(l.location)&&Rt&&typeof((p=window)==null?void 0:p.location)<"u"){let k=e.history.createURL(l.location),K=Pe(k.pathname,s)==null;if(window.location.origin!==k.origin||K){R?window.location.replace(l.location):window.location.assign(l.location);return}}D=null;let v=R===!0?j.Replace:j.Push,{formMethod:x,formAction:S,formEncType:W,formData:O}=i.navigation;!m&&x&&S&&O&&W&&(m={formMethod:x,formAction:S,formEncType:W,formData:O}),mr.has(l.status)&&m&&X(m.formMethod)?await J(v,w,{submission:L({},m,{formAction:l.location}),preventScrollReset:A}):M?await J(v,w,{overrideNavigation:{state:"loading",location:w,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},fetcherSubmission:m,preventScrollReset:A}):await J(v,w,{overrideNavigation:{state:"loading",location:w,formMethod:m?m.formMethod:void 0,formAction:m?m.formAction:void 0,formEncType:m?m.formEncType:void 0,formData:m?m.formData:void 0},preventScrollReset:A})}async function Ye(i,l,c,p,m){let R=await Promise.all([...c.map(v=>me("loader",m,v,l,r,t,s)),...p.map(v=>v.matches&&v.match&&v.controller?me("loader",ge(e.history,v.path,v.controller.signal),v.match,v.matches,r,t,s):{type:B.error,error:G(404,{pathname:v.path})})]),M=R.slice(0,c.length),w=R.slice(c.length);return await Promise.all([ft(i,c,M,M.map(()=>m.signal),!1,o.loaderData),ft(i,p.map(v=>v.match),w,p.map(v=>v.controller?v.controller.signal:null),!0)]),{results:R,loaderResults:M,fetcherResults:w}}function Se(){N=!0,Y.push(...Ce()),ne.forEach((i,l)=>{I.has(l)&&(Z.push(l),ae(l))})}function Fe(i,l,c){let p=ie(o.matches,l);Ue(i),H({errors:{[p.route.id]:c},fetchers:new Map(o.fetchers)})}function Ue(i){I.has(i)&&ae(i),ne.delete(i),de.delete(i),ce.delete(i),o.fetchers.delete(i)}function ae(i){let l=I.get(i);F(l,"Expected fetch controller: "+i),l.abort(),I.delete(i)}function Ge(i){for(let l of i){let p={state:"idle",data:Ve(l).data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};o.fetchers.set(l,p)}}function Xe(){let i=[],l=!1;for(let c of ce){let p=o.fetchers.get(c);F(p,"Expected fetcher: "+c),p.state==="loading"&&(ce.delete(c),i.push(c),l=!0)}return Ge(i),l}function qe(i){let l=[];for(let[c,p]of de)if(p<i){let m=o.fetchers.get(c);F(m,"Expected fetcher: "+c),m.state==="loading"&&(ae(c),de.delete(c),l.push(c))}return Ge(l),l.length>0}function It(i,l){let c=o.blockers.get(i)||nt;return q.get(i)!==l&&q.set(i,l),c}function he(i){o.blockers.delete(i),q.delete(i)}function De(i,l){let c=o.blockers.get(i)||nt;F(c.state==="unblocked"&&l.state==="blocked"||c.state==="blocked"&&l.state==="blocked"||c.state==="blocked"&&l.state==="proceeding"||c.state==="blocked"&&l.state==="unblocked"||c.state==="proceeding"&&l.state==="unblocked","Invalid blocker state transition: "+c.state+" -> "+l.state),o.blockers.set(i,l),H({blockers:new Map(o.blockers)})}function Je(i){let{currentLocation:l,nextLocation:c,historyAction:p}=i;if(q.size===0)return;q.size>1&&se(!1,"A router only supports one blocker at a time");let m=Array.from(q.entries()),[R,M]=m[m.length-1],w=o.blockers.get(R);if(!(w&&w.state==="proceeding")&&M({currentLocation:l,nextLocation:c,historyAction:p}))return R}function Ce(i){let l=[];return ee.forEach((c,p)=>{(!i||i(p))&&(c.cancel(),l.push(p),ee.delete(p))}),l}function zt(i,l,c){if(y=i,g=l,h=c||(p=>p.key),!E&&o.navigation===je){E=!0;let p=Qe(o.location,o.matches);p!=null&&H({restoreScrollPosition:p})}return()=>{y=null,g=null,h=null}}function Bt(i,l){if(y&&h&&g){let c=l.map(m=>ht(m,o.loaderData)),p=h(i,c)||i.key;y[p]=g()}}function Qe(i,l){if(y&&h&&g){let c=l.map(R=>ht(R,o.loaderData)),p=h(i,c)||i.key,m=y[p];if(typeof m=="number")return m}return null}function Ot(i){a=i}return b={get basename(){return s},get state(){return o},get routes(){return n},initialize:Pt,subscribe:At,enableScrollRestoration:zt,navigate:Ke,fetch:Ct,revalidate:St,createHref:i=>e.history.createHref(i),encodeLocation:i=>e.history.encodeLocation(i),getFetcher:Ve,deleteFetcher:Ue,dispose:Lt,getBlocker:It,deleteBlocker:he,_internalFetchControllers:I,_internalActiveDeferreds:ee,_internalSetRoutes:Ot},b}function wr(e){return e!=null&&"formData"in e}function Ne(e,t,r,n,a,s,d){let u,f;if(s!=null&&d!=="path"){u=[];for(let h of t)if(u.push(h),h.route.id===s){f=h;break}}else u=t,f=t[t.length-1];let y=ir(a||".",yt(u).map(h=>h.pathnameBase),Pe(e.pathname,r)||e.pathname,d==="path");return a==null&&(y.search=e.search,y.hash=e.hash),(a==null||a===""||a===".")&&f&&f.route.index&&!We(y.search)&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),n&&r!=="/"&&(y.pathname=y.pathname==="/"?r:ve([r,y.pathname])),Re(y)}function at(e,t,r,n){if(!n||!wr(n))return{path:r};if(n.formMethod&&!Pr(n.formMethod))return{path:r,error:G(405,{method:n.formMethod})};let a;if(n.formData){let u=n.formMethod||"get";if(a={formMethod:e?u.toUpperCase():u.toLowerCase(),formAction:Et(r),formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:n.formData},X(a.formMethod))return{path:r,submission:a}}let s=re(r),d=Mt(n.formData);return t&&s.search&&We(s.search)&&d.append("index",""),s.search="?"+d,{path:Re(s),submission:a}}function br(e,t){let r=e;if(t){let n=e.findIndex(a=>a.route.id===t);n>=0&&(r=e.slice(0,n))}return r}function ot(e,t,r,n,a,s,d,u,f,y,h,g,E){let _=E?Object.values(E)[0]:g?Object.values(g)[0]:void 0,C=e.createURL(t.location),U=e.createURL(a),b=E?Object.keys(E)[0]:void 0,P=br(r,b).filter((D,z)=>{if(D.route.lazy)return!0;if(D.route.loader==null)return!1;if(Rr(t.loaderData,t.matches[z],D)||d.some(Z=>Z===D.route.id))return!0;let N=t.matches[z],Y=D;return it(D,L({currentUrl:C,currentParams:N.params,nextUrl:U,nextParams:Y.params},n,{actionResult:_,defaultShouldRevalidate:s||C.pathname+C.search===U.pathname+U.search||C.search!==U.search||Dt(N,Y)}))}),A=[];return f.forEach((D,z)=>{if(!r.some(I=>I.route.id===D.routeId))return;let N=ye(y,D.path,h);if(!N){A.push({key:z,routeId:D.routeId,path:D.path,matches:null,match:null,controller:null});return}let Y=He(N,D.path);if(u.includes(z)){A.push({key:z,routeId:D.routeId,path:D.path,matches:N,match:Y,controller:new AbortController});return}it(Y,L({currentUrl:C,currentParams:t.matches[t.matches.length-1].params,nextUrl:U,nextParams:r[r.length-1].params},n,{actionResult:_,defaultShouldRevalidate:s}))&&A.push({key:z,routeId:D.routeId,path:D.path,matches:N,match:Y,controller:new AbortController})}),[P,A]}function Rr(e,t,r){let n=!t||r.route.id!==t.route.id,a=e[r.route.id]===void 0;return n||a}function Dt(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function it(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}async function lt(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let a=r[e.id];F(a,"No route found in manifest");let s={};for(let d in n){let f=a[d]!==void 0&&d!=="hasErrorBoundary";se(!f,'Route "'+a.id+'" has a static property "'+d+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+d+'" will be ignored.')),!f&&!Ht.has(d)&&(s[d]=n[d])}Object.assign(a,s),Object.assign(a,L({},t(a),{lazy:void 0}))}async function me(e,t,r,n,a,s,d,u,f,y){u===void 0&&(u=!1),f===void 0&&(f=!1);let h,g,E,_=b=>{let o,P=new Promise((A,D)=>o=D);return E=()=>o(),t.signal.addEventListener("abort",E),Promise.race([b({request:t,params:r.params,context:y}),P])};try{let b=r.route[e];if(r.route.lazy)if(b)g=(await Promise.all([_(b),lt(r.route,s,a)]))[0];else if(await lt(r.route,s,a),b=r.route[e],b)g=await _(b);else if(e==="action"){let o=new URL(t.url),P=o.pathname+o.search;throw G(405,{method:t.method,pathname:P,routeId:r.route.id})}else return{type:B.data,data:void 0};else if(b)g=await _(b);else{let o=new URL(t.url),P=o.pathname+o.search;throw G(404,{pathname:P})}F(g!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(b){h=B.error,g=b}finally{E&&t.signal.removeEventListener("abort",E)}if(xr(g)){let b=g.status;if(pr.has(b)){let A=g.headers.get("Location");if(F(A,"Redirects returned/thrown from loaders/actions must have a Location header"),!bt.test(A))A=Ne(new URL(t.url),n.slice(0,n.indexOf(r)+1),d,!0,A);else if(!u){let D=new URL(t.url),z=A.startsWith("//")?new URL(D.protocol+A):new URL(A),N=Pe(z.pathname,d)!=null;z.origin===D.origin&&N&&(A=z.pathname+z.search+z.hash)}if(u)throw g.headers.set("Location",A),g;return{type:B.redirect,status:b,location:A,revalidate:g.headers.get("X-Remix-Revalidate")!==null}}if(f)throw{type:h||B.data,response:g};let o,P=g.headers.get("Content-Type");return P&&/\bapplication\/json\b/.test(P)?o=await g.json():o=await g.text(),h===B.error?{type:h,error:new vt(b,g.statusText,o),headers:g.headers}:{type:B.data,data:o,statusCode:g.status,headers:g.headers}}if(h===B.error)return{type:h,error:g};if(Er(g)){var C,U;return{type:B.deferred,deferredData:g,statusCode:(C=g.init)==null?void 0:C.status,headers:((U=g.init)==null?void 0:U.headers)&&new Headers(g.init.headers)}}return{type:B.data,data:g}}function ge(e,t,r,n){let a=e.createURL(Et(t)).toString(),s={signal:r};if(n&&X(n.formMethod)){let{formMethod:d,formEncType:u,formData:f}=n;s.method=d.toUpperCase(),s.body=u==="application/x-www-form-urlencoded"?Mt(f):f}return new Request(a,s)}function Mt(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,n instanceof File?n.name:n);return t}function Dr(e,t,r,n,a){let s={},d=null,u,f=!1,y={};return r.forEach((h,g)=>{let E=t[g].route.id;if(F(!le(h),"Cannot handle redirect results in processLoaderData"),we(h)){let _=ie(e,E),C=h.error;n&&(C=Object.values(n)[0],n=void 0),d=d||{},d[_.route.id]==null&&(d[_.route.id]=C),s[E]=void 0,f||(f=!0,u=cr(h.error)?h.error.status:500),h.headers&&(y[E]=h.headers)}else te(h)?(a.set(E,h.deferredData),s[E]=h.deferredData.data):s[E]=h.data,h.statusCode!=null&&h.statusCode!==200&&!f&&(u=h.statusCode),h.headers&&(y[E]=h.headers)}),n&&(d=n,s[Object.keys(n)[0]]=void 0),{loaderData:s,errors:d,statusCode:u||200,loaderHeaders:y}}function st(e,t,r,n,a,s,d,u){let{loaderData:f,errors:y}=Dr(t,r,n,a,u);for(let h=0;h<s.length;h++){let{key:g,match:E,controller:_}=s[h];F(d!==void 0&&d[h]!==void 0,"Did not find corresponding fetcher result");let C=d[h];if(!(_&&_.signal.aborted))if(we(C)){let U=ie(e.matches,E==null?void 0:E.route.id);y&&y[U.route.id]||(y=L({},y,{[U.route.id]:C.error})),e.fetchers.delete(g)}else if(le(C))F(!1,"Unhandled fetcher revalidation redirect");else if(te(C))F(!1,"Unhandled fetcher deferred data");else{let U={state:"idle",data:C.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};e.fetchers.set(g,U)}}return{loaderData:f,errors:y}}function dt(e,t,r,n){let a=L({},t);for(let s of r){let d=s.route.id;if(t.hasOwnProperty(d)?t[d]!==void 0&&(a[d]=t[d]):e[d]!==void 0&&s.route.loader&&(a[d]=e[d]),n&&n.hasOwnProperty(d))break}return a}function ie(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function ct(e){let t=e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function G(e,t){let{pathname:r,routeId:n,method:a,type:s}=t===void 0?{}:t,d="Unknown Server Error",u="Unknown @remix-run/router error";return e===400?(d="Bad Request",a&&r&&n?u="You made a "+a+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":s==="defer-action"&&(u="defer() is not supported in actions")):e===403?(d="Forbidden",u='Route "'+n+'" does not match URL "'+r+'"'):e===404?(d="Not Found",u='No route matches URL "'+r+'"'):e===405&&(d="Method Not Allowed",a&&r&&n?u="You made a "+a.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":a&&(u='Invalid request method "'+a.toUpperCase()+'"')),new vt(e||500,d,new Error(u),!0)}function ut(e){for(let t=e.length-1;t>=0;t--){let r=e[t];if(le(r))return r}}function Et(e){let t=typeof e=="string"?re(e):e;return Re(L({},t,{hash:""}))}function Mr(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function te(e){return e.type===B.deferred}function we(e){return e.type===B.error}function le(e){return(e&&e.type)===B.redirect}function Er(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function xr(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Pr(e){return hr.has(e.toLowerCase())}function X(e){return ur.has(e.toLowerCase())}async function ft(e,t,r,n,a,s){for(let d=0;d<r.length;d++){let u=r[d],f=t[d];if(!f)continue;let y=e.find(g=>g.route.id===f.route.id),h=y!=null&&!Dt(y,f)&&(s&&s[f.route.id])!==void 0;if(te(u)&&(a||h)){let g=n[d];F(g,"Expected an AbortSignal for revalidating fetcher deferred result"),await xt(u,g,a).then(E=>{E&&(r[d]=E||r[d])})}}}async function xt(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:B.data,data:e.deferredData.unwrappedData}}catch(a){return{type:B.error,error:a}}return{type:B.data,data:e.deferredData.data}}}function We(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function ht(e,t){let{route:r,pathname:n,params:a}=e;return{id:r.id,pathname:n,params:a,data:t[r.id],handle:r.handle}}function He(e,t){let r=typeof t=="string"?re(t).search:t.search;if(e[e.length-1].route.index&&We(r||""))return e[e.length-1];let n=yt(e);return n[n.length-1]}export{j as A,vt as E,cr as a,Lr as b,Ar as c,Re as d,yt as g,F as i,ve as j,ye as m,re as p,ir as r,Pe as s};
